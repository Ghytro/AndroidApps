#:import threading threading
<RootWidget>:
    ScreenManager:
        id: main_screen_manager

        SubScreen:
            id: subscreen
            name: 'subscreen'
        
        LoadingScreen:
            id: loadingscreen
            name: 'loadingscreen'
        
        DownloadScreen:
            id: downloadscreen
            name: 'downloadscreen'

<SubScreen>:
    BoxLayout:
        orientation: 'vertical'
        #size_hint: 1, .9
        pos_hint: {'top': 1}
        spacing: 50
        MDToolbar:
            title: "YTDownloader"
        MDTextField:
            id: ytlink
            multiline: False
            size_hint: .5, None
            pos_hint: {'center_x': .5}
            font_size: 12
            line_color_normal: .5, .5, .5, 1
            color_mode: 'accent'
            hint_text: 'Link'
            helper_text: 'Enter the link of a YouTube video you want do download'
            helper_text_mode: 'on_focus'
        MDRoundFlatIconButton:
            text: "Select folder"
            icon: "folder"
            pos_hint: {"center_x": .5}
            on_release: threading.Thread(target=app.root.open_file_manager, args=(root.ids.dirname,)).start()
        MDRoundFlatButton:
            text: "Download!"
            pos_hint: {'center_x': .5}
            on_release: threading.Thread(target=app.root.download_video, args=(root.ids.ytlink.text, root.ids.dirname.text, root.ids.errlabel)).start()
        MDLabel:
            id: dirname
            text: ""
            font_size: 12
            theme_text_color: 'Secondary'
            halign: "center"
        MDLabel:
            id: errlabel
            text: ""
            font_size: 12
            theme_text_color: 'Primary'
            halign: 'center'

<LoadingScreen>:
    MDSpinner:
        size_hint: None, None
        size: dp(46), dp(46)
        pos_hint: {'center_x': .5, 'center_y': .5}
        active: True
    MDLabel:
        text: "Please, wait..."
        theme_text_color: 'Primary'
        font_size: 18
        halign: 'center'
        pos_hint: {'center_y': .6}

<DownloadScreen>:
    BoxLayout:
        orientation: 'vertical'
        padding: 100
        MDCard:
            size: "480dp", "360dp"
            size_hint: None, None
            id: preview
            pos_hint: {"center_x": .5}
            RelativeLayout:
                AsyncImage:
                    id: preview_img
                    source: "thumbnail.jpg"
                    size: root.children[0].children[0].children[0].size
                    allow_stretch: True
                MDLabel:
                    id: video_title
                    text: "Title"
                    markup: True
                    size_hint_y: None
                    height: self.texture_size[1]
                    x: "10dp"
                    y: "10dp"
                    theme_text_color: "Custom"
                    text_color: 1, 1, 1, 1
        
        MDRoundFlatIconButton:
            icon: "library-video"
            text: "Resolution"
            pos_hint: {"center_x": .5}
